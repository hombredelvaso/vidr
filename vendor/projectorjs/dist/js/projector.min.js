!function(t,e){if("function"==typeof define&&define.amd)define(["videojs"],e);else if("object"==typeof exports){var r=void 0;try{r=require("video.js")}catch(n){}module.exports=e(r)}else t.Projector=e(t.videojs)}(this,function(t){"use strict";var e=0,r=function(t,r,n){n=n||!1;var i=this;if(this.element=t,this.coptions=r,this.overlays=[],this.vjs=n,n)this.wrapper=t.el(),t.addEventListener=t.on,t.projector=this;else{var o=t.parentNode,s=document.createElement("div");s.setAttribute("data-projectorid",e),s.setAttribute("class","projector-wrapper"),o.replaceChild(s,t),s.appendChild(t),this.wrapper=s,t.addEventListener("loadedmetadata",function(){var e=t.offsetHeight,r=t.offsetWidth;i.wrapper.style.height=e+"px",i.wrapper.style.width=r+"px"})}r&&r.overlays&&r.overlays.forEach(function(t){t.overlay;i.addOverlay(t.overlay,t)}),t.addEventListener("fullscreenchange",function(){for(var t=document.getElementsByClassName("projector-overlay"),e=0;e<t.length;e++)t[e].style.fontSize=.01*i.wrapper.offsetWidth+"px"}),t.addEventListener("timeupdate",function(){i.getSeeking()?i.updateOverlays(!0):i.updateOverlays()}),e++};r.prototype.updateOverlays=function(t){var e=this.getCurrentTime();this.overlays.forEach(function(r){r.update(e,t)})},r.prototype.setPositionAttributes=function(t,e){["top","right","left","bottom","height","width"].forEach(function(r){e[r]&&(t.style[r]=e[r])})},r.prototype.unwindTimings=function(t){var e=[];return t.forEach(function(t){if(t.timing){var r=t.timing.split(",");r.forEach(function(r){var n={},i=r.split("-");n.start=i[0],n.end=i[1],n.beforeBeginOverlay=t.beforeBeginOverlay,n.afterBeginOverlay=t.afterBeginOverlay,n.beforeEndOverlay=t.beforeEndOverlay,n.afterEndOverlay=t.afterEndOverlay,e.push(n)})}else e.push(t)}),e},r.prototype.getCurrentTime=function(){return this.vjs?this.element.currentTime():this.element.currentTime},r.prototype.getSeeking=function(){return this.vjs?this.element.seeking():this.element.seeking},r.prototype.addOverlay=function(t,e){var r=this,n=document.createElement("div");return n.setAttribute("class","projector-overlay"),this.setPositionAttributes(n,e),n.appendChild(t.el),n.style.fontSize=.01*this.wrapper.offsetWidth+"px",t.wrapper=n,t.__timings=this.unwindTimings(e.timings),t.__timings.forEach(function(e){["start","end"].forEach(function(n){"string"==typeof e[n]&&r.element.addEventListener(e[n],function(){var i=r.getCurrentTime();"start"===n?t.__runBeginOverlay(e,i,!1):t.__runEndOverlay(e,i,!1)})})}),this.overlays.push(t),this.wrapper.insertBefore(n,this.wrapper.childNodes[0]),this};var n=function(){var t=Array.prototype.slice.call(arguments);t.shift(),"function"==typeof arguments[0]&&arguments[0].apply(this,t)},i=function(){var t=function(e){var r=Object.create(t.prototype);return r.init(e),r};return t.prototype={},t.prototype.options={},t.prototype.element=void 0,t.prototype.class="",t.prototype.init=function(t){return this.options=t||{},this.options.attrs=this.options.attrs||{},this.el=this.render(),this},t.prototype.render=function(){var t=this,e=document.createElement("div");e.style.display="none",e.setAttribute("class",t.class+" projector-overlay-item");for(var r in this.options.attrs)"class"===r?e.setAttribute(r,t.class?t.class+" "+this.options.attrs[r]:this.options.attrs[r]):e.setAttribute(r,this.options.attrs[r]);return e},t.prototype.isActive=function(){return this.__timings.some(function(t){return t.active===!0})},t.prototype.__runBeginOverlay=function(t,e,r){var i=this;n(t.beforeBeginOverlay,this,e,r),this.beginOverlay(function(){n(t.afterBeginOverlay,i,e,r)},e,r),t.active=!0},t.prototype.__runEndOverlay=function(t,e,r){var i=this;n(t.beforeEndOverlay,this,e,r),this.endOverlay(function(){n(t.afterEndOverlay,i,e,r)},e,r),t.active=!1},t.prototype.beginOverlay=function(t){this.el.style.display="block",t()},t.prototype.endOverlay=function(t){this.el.style.display="none",t()},t.prototype.update=function(t,e){var r=this;e=e||!1,this.__timings.forEach(function(n){!n.active&&(t>=n.start&&t<=n.end||t>=n.start&&void 0===n.end)?r.__runBeginOverlay(n,t,e):n.active&&(t<n.start||t>n.end)&&r.__runEndOverlay(n,t,e)})},t}(),o=function(){var t=function(e){var r=Object.create(t.prototype);return r.init(e),r};return t.prototype=Object.create(i.prototype),t.prototype.class="projector-textbox",t.prototype.init=function(){i.prototype.init.apply(this,arguments)},t.prototype.render=function(){var t=i.prototype.render.call(this);return t.innerHTML=this.options.text,t},t}(),s=function(){var t=function(e){var r=Object.create(t.prototype);return r.init(e),r};return t.prototype=Object.create(i.prototype),t.prototype.init=function(){i.prototype.init.apply(this,arguments)},t.prototype.render=function(){var t=i.prototype.render.call(this);return t.innerHTML=this.options.html,t},t}(),a={VERSION:"0.1.0",init:function(t,e){return"string"==typeof t&&(t=document.getElementById(t)),new r(t,e)},initVjs:function(t){return this.projector=new r(this,t,!0),this.projector}};return t&&t.plugin("projector",a.initVjs),a.Overlay=i,a.TextBox=o,a.HTMLBox=s,a});
//# sourceMappingURL=projector.js.map